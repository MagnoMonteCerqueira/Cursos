<?xml version="1.0" encoding="UTF-8"?>
<zabbix_export>
    <version>6.0</version>
    <date>2022-07-01T05:28:36Z</date>
    <groups>
        <group>
            <uuid>56319b9a00164b24abad1a11bb8e96fe</uuid>
            <name>Hosts/KSC</name>
        </group>
    </groups>
    <templates>
        <template>
            <uuid>308e15deda484cc9b099bffd09a6f678</uuid>
            <template>Template_ODBC_KSC-13_versao-0.0.01</template>
            <name>Template_ODBC_KSC-13_versao-0.0.01</name>
            <groups>
                <group>
                    <name>Hosts/KSC</name>
                </group>
            </groups>
            <items>
                <item>
                    <uuid>90a488c4a9b5478683e1d96791eec3d4</uuid>
                    <name>01- Descoberta global raw hosts</name>
                    <type>ODBC</type>
                    <key>db.odbc.get[Descoberta-raw-hosts,{$BANCO_DADOS}]</key>
                    <trends>0</trends>
                    <value_type>TEXT</value_type>
                    <params>SELECT 

kavhosts.nId,kavhosts.strWinHostName,kavhosts.nStatus,kavhosts.nLastRtpState,kavhosts.nOSName,kavhosts.nLastFullScan,

kavosname.wstrOSName,

kavhoststatus.nLastStatus,

kavhostav.wstrNagentBuild,kavhostav.wstrAvBuild,kavhostav.tmAvBasesDate,

kavavbase.bHasInactualAvBases



FROM [KAV].[dbo].[Hosts] as kavhosts

INNER JOIN [KAV].[dbo].[hst_os_name] as kavosname ON kavosname.nId = kavhosts.nOSName

INNER JOIN [KAV].[dbo].[hst_host_status] as kavhoststatus ON kavhoststatus.nId = kavhosts.nId

INNER JOIN [KAV].[dbo].[v_hst_prdstates_grp] as kavhostav ON kavhostav.nHostId = kavhosts.nId

INNER JOIN [KAV].[dbo].[v_hst_avbases_inactual] as kavavbase ON kavavbase.nId = kavhosts.nId</params>
                    <username>{$USERNAME}</username>
                    <password>{$PASSWORD}</password>
                    <preprocessing>
                        <step>
                            <type>STR_REPLACE</type>
                            <parameters>
                                <parameter>null</parameter>
                                <parameter>1</parameter>
                            </parameters>
                        </step>
                    </preprocessing>
                    <tags>
                        <tag>
                            <tag>Descobertas globais raw</tag>
                        </tag>
                    </tags>
                </item>
                <item>
                    <uuid>fc1062681f6844fcbbbe0cb7231ac15a</uuid>
                    <name>02- Descoberta global raw Quantidade de virus em todos os hosts</name>
                    <type>ODBC</type>
                    <key>db.odbc.get[Descoberta-raw-virus-count,{$BANCO_DADOS}]</key>
                    <trends>0</trends>
                    <value_type>TEXT</value_type>
                    <params>SELECT sum(nVirusCount) AS total_de_infeccoes, sum(nVirusCountBase) AS total_de_desinfeccoes

FROM [KAV].[dbo].[Hosts]</params>
                    <username>{$USERNAME}</username>
                    <password>{$PASSWORD}</password>
                    <preprocessing>
                        <step>
                            <type>STR_REPLACE</type>
                            <parameters>
                                <parameter>null</parameter>
                                <parameter>1</parameter>
                            </parameters>
                        </step>
                    </preprocessing>
                    <tags>
                        <tag>
                            <tag>Descobertas globais raw</tag>
                        </tag>
                    </tags>
                </item>
                <item>
                    <uuid>c808bdd7d3244017a46df1d57c8992d7</uuid>
                    <name>Desktops com alertas</name>
                    <type>DEPENDENT</type>
                    <key>Quantidade.desktops.alertas</key>
                    <delay>0</delay>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <parameters>
                                <parameter>$[?(@.nOSName == '2' &amp;&amp; @.nLastStatus &gt; '1')].nLastStatus.length()</parameter>
                            </parameters>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>db.odbc.get[Descoberta-raw-hosts,{$BANCO_DADOS}]</key>
                    </master_item>
                    <tags>
                        <tag>
                            <tag>Informacoes dos dispositivos</tag>
                        </tag>
                    </tags>
                </item>
                <item>
                    <uuid>4c05ec504ef946518547809ee95cb19b</uuid>
                    <name>Desktops atualizados</name>
                    <type>DEPENDENT</type>
                    <key>Quantidade.Desktops.atualizados</key>
                    <delay>0</delay>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <parameters>
                                <parameter>$[?(@.nOSName == '2' &amp;&amp; @.bHasInactualAvBases == '0')].bHasInactualAvBases.length()</parameter>
                            </parameters>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>db.odbc.get[Descoberta-raw-hosts,{$BANCO_DADOS}]</key>
                    </master_item>
                    <tags>
                        <tag>
                            <tag>Informacoes de updade database</tag>
                        </tag>
                    </tags>
                </item>
                <item>
                    <uuid>b9eaf35b6bb94531aeac0450a6d5c9b7</uuid>
                    <name>Desktops criticos</name>
                    <type>DEPENDENT</type>
                    <key>Quantidade.desktops.criticos</key>
                    <delay>0</delay>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <parameters>
                                <parameter>$[?(@.nOSName == '2' &amp;&amp; @.nLastStatus =='1')].nLastStatus.length()</parameter>
                            </parameters>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>db.odbc.get[Descoberta-raw-hosts,{$BANCO_DADOS}]</key>
                    </master_item>
                    <tags>
                        <tag>
                            <tag>Informacoes dos dispositivos</tag>
                        </tag>
                    </tags>
                </item>
                <item>
                    <uuid>d05ee0d66b694bf7a326b84eef8f80d1</uuid>
                    <name>Desktops nao atualizados</name>
                    <type>DEPENDENT</type>
                    <key>Quantidade.Desktops.nao.atualizados</key>
                    <delay>0</delay>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <parameters>
                                <parameter>$[?(@.nOSName == '2' &amp;&amp; @.bHasInactualAvBases &gt; '0')].bHasInactualAvBases.length()</parameter>
                            </parameters>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>db.odbc.get[Descoberta-raw-hosts,{$BANCO_DADOS}]</key>
                    </master_item>
                    <tags>
                        <tag>
                            <tag>Informacoes de updade database</tag>
                        </tag>
                    </tags>
                </item>
                <item>
                    <uuid>dd09b7daef384e0ca0cd10c0630cc0a5</uuid>
                    <name>Desktops nao escaneados</name>
                    <type>DEPENDENT</type>
                    <key>Quantidade.Desktops.nao.escaneados</key>
                    <delay>0</delay>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <parameters>
                                <parameter>$[?(@.nOSName == '2' &amp;&amp; @.nLastFullScan == '1' )].nLastFullScan.length()</parameter>
                            </parameters>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>db.odbc.get[Descoberta-raw-hosts,{$BANCO_DADOS}]</key>
                    </master_item>
                    <tags>
                        <tag>
                            <tag>Informacoes de computadores escaneados</tag>
                        </tag>
                    </tags>
                </item>
                <item>
                    <uuid>21cda2fe80714aaaaed8f47a2d5c1301</uuid>
                    <name>Desktops scaneados</name>
                    <type>DEPENDENT</type>
                    <key>Quantidade.Desktops.scaneados</key>
                    <delay>0</delay>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <parameters>
                                <parameter>$[?(@.nOSName == '2' &amp;&amp; @.nLastFullScan &gt; '1' )].nLastFullScan.length()</parameter>
                            </parameters>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>db.odbc.get[Descoberta-raw-hosts,{$BANCO_DADOS}]</key>
                    </master_item>
                    <tags>
                        <tag>
                            <tag>Informacoes de computadores escaneados</tag>
                        </tag>
                    </tags>
                </item>
                <item>
                    <uuid>9004b2f675a34632b2d397272e057267</uuid>
                    <name>Dispositivos online</name>
                    <type>DEPENDENT</type>
                    <key>Quantidade.dispositivos.online</key>
                    <delay>0</delay>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <parameters>
                                <parameter>$[?(@.nLastRtpState &gt; '3')].nLastRtpState.length()</parameter>
                            </parameters>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>db.odbc.get[Descoberta-raw-hosts,{$BANCO_DADOS}]</key>
                    </master_item>
                    <tags>
                        <tag>
                            <tag>Informacoes dos dispositivos online e offline</tag>
                        </tag>
                    </tags>
                </item>
                <item>
                    <uuid>5cc8cbd4e7bf47e6afa90ac64b5925a0</uuid>
                    <name>Dispositivos parados</name>
                    <type>DEPENDENT</type>
                    <key>Quantidade.dispositivos.parados</key>
                    <delay>0</delay>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <parameters>
                                <parameter>$[?(@.nLastRtpState == '1')].nLastRtpState.length()</parameter>
                            </parameters>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>db.odbc.get[Descoberta-raw-hosts,{$BANCO_DADOS}]</key>
                    </master_item>
                    <tags>
                        <tag>
                            <tag>Informacoes dos dispositivos online e offline</tag>
                        </tag>
                    </tags>
                </item>
                <item>
                    <uuid>2bf77a976c4748bcb9a3ec0ffde135b1</uuid>
                    <name>Total de Dispositivos</name>
                    <type>DEPENDENT</type>
                    <key>Quantidade.pcs</key>
                    <delay>0</delay>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <parameters>
                                <parameter>$[?(@.strWinHostName)].strWinHostName.length()</parameter>
                            </parameters>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>db.odbc.get[Descoberta-raw-hosts,{$BANCO_DADOS}]</key>
                    </master_item>
                    <tags>
                        <tag>
                            <tag>Informacoes dos computadores</tag>
                        </tag>
                    </tags>
                </item>
                <item>
                    <uuid>ebe346d6fe4a450bb34dcf43288f1193</uuid>
                    <name>Dispositivos OK</name>
                    <type>DEPENDENT</type>
                    <key>Quantidade.pcs.ok</key>
                    <delay>0</delay>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <parameters>
                                <parameter>$[?(@.nLastStatus == '0')].nLastStatus.length()</parameter>
                            </parameters>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>db.odbc.get[Descoberta-raw-hosts,{$BANCO_DADOS}]</key>
                    </master_item>
                    <tags>
                        <tag>
                            <tag>Informacoes dos dispositivos</tag>
                        </tag>
                    </tags>
                </item>
                <item>
                    <uuid>5ffa27403b2942588e1d524889179636</uuid>
                    <name>Protecao completa</name>
                    <type>DEPENDENT</type>
                    <key>Quantidade.protecao.completa</key>
                    <delay>0</delay>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <parameters>
                                <parameter>$[?(@.nStatus == '29' )].nStatus.length()</parameter>
                            </parameters>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>db.odbc.get[Descoberta-raw-hosts,{$BANCO_DADOS}]</key>
                    </master_item>
                    <tags>
                        <tag>
                            <tag>Informacoes de protecao</tag>
                        </tag>
                    </tags>
                </item>
                <item>
                    <uuid>f0a13d30032b4a51b42738aade2f6649</uuid>
                    <name>Dispositivos sem comunicacao</name>
                    <type>DEPENDENT</type>
                    <key>Quantidade.sem.comunicacao</key>
                    <delay>0</delay>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <parameters>
                                <parameter>$[?(@.nLastRtpState == '0')].nLastRtpState.length()</parameter>
                            </parameters>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>db.odbc.get[Descoberta-raw-hosts,{$BANCO_DADOS}]</key>
                    </master_item>
                    <tags>
                        <tag>
                            <tag>Informacoes dos dispositivos online e offline</tag>
                        </tag>
                    </tags>
                </item>
                <item>
                    <uuid>74584de4468443718cdbc0519e91f9a4</uuid>
                    <name>Sem Protecao</name>
                    <type>DEPENDENT</type>
                    <key>Quantidade.sem.protecao</key>
                    <delay>0</delay>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <parameters>
                                <parameter>$[?(@.nStatus == '13' )].nStatus.length()</parameter>
                            </parameters>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>db.odbc.get[Descoberta-raw-hosts,{$BANCO_DADOS}]</key>
                    </master_item>
                    <tags>
                        <tag>
                            <tag>Informacoes de protecao</tag>
                        </tag>
                    </tags>
                </item>
                <item>
                    <uuid>3ab2aeddea8c4a15a848023cb7d34faf</uuid>
                    <name>Servidores atualizados</name>
                    <type>DEPENDENT</type>
                    <key>Quantidade.servidores.atualizados</key>
                    <delay>0</delay>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <parameters>
                                <parameter>$[?(@.nOSName == '1' &amp;&amp; @.bHasInactualAvBases == '0')].bHasInactualAvBases.length()</parameter>
                            </parameters>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>db.odbc.get[Descoberta-raw-hosts,{$BANCO_DADOS}]</key>
                    </master_item>
                    <tags>
                        <tag>
                            <tag>Informacoes de updade database</tag>
                        </tag>
                    </tags>
                </item>
                <item>
                    <uuid>991537b1138e47ed80c98c16994d0168</uuid>
                    <name>Servidores com alertas</name>
                    <type>DEPENDENT</type>
                    <key>Quantidade.servidores.com.alertas</key>
                    <delay>0</delay>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <parameters>
                                <parameter>$[?(@.nOSName == '1' &amp;&amp; @.nLastStatus &gt; '1')].nLastStatus.length()</parameter>
                            </parameters>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>db.odbc.get[Descoberta-raw-hosts,{$BANCO_DADOS}]</key>
                    </master_item>
                    <tags>
                        <tag>
                            <tag>Informacoes dos dispositivos</tag>
                        </tag>
                    </tags>
                </item>
                <item>
                    <uuid>d83708438986466a96ee3d03f80c02c3</uuid>
                    <name>Servidores criticos</name>
                    <type>DEPENDENT</type>
                    <key>Quantidade.servidores.criticos</key>
                    <delay>0</delay>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <parameters>
                                <parameter>$[?(@.nOSName == '1' &amp;&amp; @.nLastStatus =='1')].nLastStatus.length()</parameter>
                            </parameters>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>db.odbc.get[Descoberta-raw-hosts,{$BANCO_DADOS}]</key>
                    </master_item>
                    <tags>
                        <tag>
                            <tag>Informacoes dos dispositivos</tag>
                        </tag>
                    </tags>
                </item>
                <item>
                    <uuid>9188b647ca9f426db67759c377ed734b</uuid>
                    <name>Servidores nao atualizados</name>
                    <type>DEPENDENT</type>
                    <key>Quantidade.servidores.nao.atualizados</key>
                    <delay>0</delay>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <parameters>
                                <parameter>$[?(@.nOSName == '1' &amp;&amp; @.bHasInactualAvBases &gt; '0')].bHasInactualAvBases.length()</parameter>
                            </parameters>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>db.odbc.get[Descoberta-raw-hosts,{$BANCO_DADOS}]</key>
                    </master_item>
                    <tags>
                        <tag>
                            <tag>Informacoes de updade database</tag>
                        </tag>
                    </tags>
                </item>
                <item>
                    <uuid>54fe702d04c24865b1fc2ce0f4e1229e</uuid>
                    <name>Servidores nao escaneados</name>
                    <type>DEPENDENT</type>
                    <key>Quantidade.servidores.nao.escaneados</key>
                    <delay>0</delay>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <parameters>
                                <parameter>$[?(@.nOSName == '1' &amp;&amp; @.nLastFullScan == '1' )].nLastFullScan.length()</parameter>
                            </parameters>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>db.odbc.get[Descoberta-raw-hosts,{$BANCO_DADOS}]</key>
                    </master_item>
                    <tags>
                        <tag>
                            <tag>Informacoes de computadores escaneados</tag>
                        </tag>
                    </tags>
                </item>
                <item>
                    <uuid>edd27cfbe1e047c8b2e022cec346d7c1</uuid>
                    <name>Servidores scaneados</name>
                    <type>DEPENDENT</type>
                    <key>Quantidade.servidores.scaneados</key>
                    <delay>0</delay>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <parameters>
                                <parameter>$[?(@.nOSName == '1' &amp;&amp; @.nLastFullScan &gt; '1' )].nLastFullScan.length()</parameter>
                            </parameters>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>db.odbc.get[Descoberta-raw-hosts,{$BANCO_DADOS}]</key>
                    </master_item>
                    <tags>
                        <tag>
                            <tag>Informacoes de computadores escaneados</tag>
                        </tag>
                    </tags>
                </item>
                <item>
                    <uuid>df8fecccb54b4d28b00a023e3c1dd365</uuid>
                    <name>Total de desinfecções</name>
                    <type>DEPENDENT</type>
                    <key>Total.de.desinfeccoes</key>
                    <delay>0</delay>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <parameters>
                                <parameter>$..total_de_desinfeccoes</parameter>
                            </parameters>
                        </step>
                        <step>
                            <type>STR_REPLACE</type>
                            <parameters>
                                <parameter>[&quot;</parameter>
                                <parameter/>
                            </parameters>
                        </step>
                        <step>
                            <type>STR_REPLACE</type>
                            <parameters>
                                <parameter>&quot;]</parameter>
                                <parameter/>
                            </parameters>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>db.odbc.get[Descoberta-raw-virus-count,{$BANCO_DADOS}]</key>
                    </master_item>
                    <tags>
                        <tag>
                            <tag>Informacoes de virus</tag>
                        </tag>
                    </tags>
                </item>
                <item>
                    <uuid>11b653a11133499c9fc542e3bad551b1</uuid>
                    <name>Total de infecções</name>
                    <type>DEPENDENT</type>
                    <key>Total.de.infeccoes</key>
                    <delay>0</delay>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <parameters>
                                <parameter>$..total_de_infeccoes</parameter>
                            </parameters>
                        </step>
                        <step>
                            <type>STR_REPLACE</type>
                            <parameters>
                                <parameter>[&quot;</parameter>
                                <parameter/>
                            </parameters>
                        </step>
                        <step>
                            <type>STR_REPLACE</type>
                            <parameters>
                                <parameter>&quot;]</parameter>
                                <parameter/>
                            </parameters>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>db.odbc.get[Descoberta-raw-virus-count,{$BANCO_DADOS}]</key>
                    </master_item>
                    <tags>
                        <tag>
                            <tag>Informacoes de virus</tag>
                        </tag>
                    </tags>
                </item>
            </items>
            <macros>
                <macro>
                    <macro>{$BANCO_DADOS}</macro>
                    <value>KSC</value>
                </macro>
                <macro>
                    <macro>{$PASSWORD}</macro>
                    <value>zabbix</value>
                </macro>
                <macro>
                    <macro>{$USERNAME}</macro>
                    <value>zabbix</value>
                </macro>
            </macros>
            <valuemaps>
                <valuemap>
                    <uuid>e0cc7bf263194c49a89ae46e80bd78ac</uuid>
                    <name>Status dos equipamentos</name>
                    <mappings>
                        <mapping>
                            <value>1</value>
                            <newvalue>Critico!</newvalue>
                        </mapping>
                        <mapping>
                            <value>2</value>
                            <newvalue>Alerta!</newvalue>
                        </mapping>
                    </mappings>
                </valuemap>
            </valuemaps>
        </template>
    </templates>
</zabbix_export>
